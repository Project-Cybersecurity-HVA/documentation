"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[252],{1252:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/wazuh_alert_system_log_cleared-33f7eba66789c77ad610622014ed99e6.png"},2374:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/wazuh_alert_powershell_activated-8b37a77ae6e7f67d00f4625901cc0577.png"},3224:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/wazuh_alert_registry_key_modified-086aea9740f1433995295c5c3a807ff1.png"},3979:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/event_viewer_system_log_cleared-049aa9ddad4553d19ab1cf32db2be1ef.png"},6082:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"testen_van_de_usecases","title":"Testen van de Usecases","description":"_NOTE:_ De logging moet via audit policy toegestaan zijn voor verschillende Windows usecases, zoals beschreven in het Functioneel ontwerp","source":"@site/docs/testen_van_de_usecases.md","sourceDirName":".","slug":"/testen_van_de_usecases","permalink":"/documentation/docs/testen_van_de_usecases","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/testen_van_de_usecases.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Installatie en Configuratie","permalink":"/documentation/docs/Installatie_en_Configuratie"},"next":{"title":"Installatie en Deploy van de Wazuh Windows-Agent","permalink":"/documentation/docs/wazuh/agent_configuratie"}}');var r=n(4848),a=n(8453);const i={},c="Testen van de Usecases",o={},l=[{value:"Usecase Wissen van de Windows Logs",id:"usecase-wissen-van-de-windows-logs",level:2},{value:"Usecase Detectie van PowerShell-gebruik",id:"usecase-detectie-van-powershell-gebruik",level:2},{value:"Usecase Detectie van persistente aanvallen via Windows Registry Runkeys",id:"usecase-detectie-van-persistente-aanvallen-via-windows-registry-runkeys",level:2}];function d(e){const s={blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"testen-van-de-usecases",children:"Testen van de Usecases"})}),"\n",(0,r.jsxs)(s.blockquote,{children:["\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.em,{children:"NOTE:"})})," De logging moet via audit policy toegestaan zijn voor verschillende Windows usecases, zoals beschreven in het Functioneel ontwerp"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"usecase-wissen-van-de-windows-logs",children:"Usecase Wissen van de Windows Logs"}),"\n",(0,r.jsx)(s.p,{children:"Uit te voeren met het volgende commmando in PowerShell met beheerrechten:"}),"\n",(0,r.jsxs)(s.p,{children:["Voor het wissen van Systeem logs:\n",(0,r.jsx)(s.code,{children:"Clear-EventLog -LogName System"})]}),"\n",(0,r.jsxs)(s.p,{children:["Voor het wissen van Security logs:\n",(0,r.jsx)(s.code,{children:"Clear-EventLog -LogName Security"})]}),"\n",(0,r.jsx)(s.p,{children:"In de event viewer is het event gelijk te zien en een paar seconden later in Wazuh alert viewer:"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Event Viewer:"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Eventviewer usecase logs",src:n(3979).A+"",width:"806",height:"412"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Wazuh Alert:"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Wazuh alert system log cleared",src:n(1252).A+"",width:"1189",height:"1054"})}),"\n",(0,r.jsx)(s.h2,{id:"usecase-detectie-van-powershell-gebruik",children:"Usecase Detectie van PowerShell-gebruik"}),"\n",(0,r.jsx)(s.p,{children:"Uit te voeren met het volgende commmando in PowerShell met beheerrechten:"}),"\n",(0,r.jsxs)(s.p,{children:["Voor het activeren van Powershell:\n",(0,r.jsx)(s.code,{children:"Start-Process Powershell.exe"})]}),"\n",(0,r.jsx)(s.p,{children:"In de event viewer is het event gelijk te zien en een paar seconden later in Wazuh alert viewer:"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Wazuh Alert:"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Wazuh alert system log cleared",src:n(2374).A+"",width:"1272",height:"724"})}),"\n",(0,r.jsx)(s.h2,{id:"usecase-detectie-van-persistente-aanvallen-via-windows-registry-runkeys",children:"Usecase Detectie van persistente aanvallen via Windows Registry Runkeys"}),"\n",(0,r.jsx)(s.p,{children:"Uit te voeren met het volgende commmando in PowerShell met beheerrechten:"}),"\n",(0,r.jsx)(s.p,{children:"Voor het activeren van Powershell:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'New-ItemProperty -Path "HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run" `\n-Name "TestPersister" -Value "C:\\Windows\\System32\\notepad.exe" -PropertyType "String"\n'})}),"\n",(0,r.jsx)(s.p,{children:"In de event viewer is het event gelijk te zien en een FIM system check later in Wazuh alert viewer en FIM module viewer:"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Wazuh Alert:"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Wazuh alert system log cleared",src:n(3224).A+"",width:"1722",height:"602"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Wazuh FIM events:"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Wazuh alert system log cleared",src:n(7817).A+"",width:"1427",height:"674"})})]})}function h(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},7817:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/wazuh_alert_viewer_registry-41109355c380560b231777eafd7b03c6.png"},8453:(e,s,n)=>{n.d(s,{R:()=>i,x:()=>c});var t=n(6540);const r={},a=t.createContext(r);function i(e){const s=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(a.Provider,{value:s},e.children)}}}]);