"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[131],{7649:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"technisch_ontwerp","title":"Technisch Ontwerp - Project Cyber Security","description":"Inleiding","source":"@site/docs/technisch_ontwerp.md","sourceDirName":".","slug":"/technisch_ontwerp","permalink":"/documentation/docs/technisch_ontwerp","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/technisch_ontwerp.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Functioneel Ontwerp - Project Cyber Security","permalink":"/documentation/docs/functioneel_ontwerp"},"next":{"title":"Onderzoeksresultaten","permalink":"/documentation/docs/onderzoekresultaten"}}');var r=i(4848),l=i(8453);const d={},t="Technisch Ontwerp - Project Cyber Security",c={},a=[{value:"Inleiding",id:"inleiding",level:2},{value:"Doel",id:"doel",level:3},{value:"Doelgroep",id:"doelgroep",level:3},{value:"Technische uitgangspunten",id:"technische-uitgangspunten",level:3},{value:"Usecases",id:"usecases",level:2},{value:"Detectie van credential attacks op Windows",id:"detectie-van-credential-attacks-op-windows",level:3},{value:"Scenario: Password spraying",id:"scenario-password-spraying",level:3},{value:"Detectie van malware",id:"detectie-van-malware",level:3},{value:"Toevoeging aan administratorsgroep",id:"toevoeging-aan-administratorsgroep",level:3},{value:"Bruteforce op Windows 11",id:"bruteforce-op-windows-11",level:3},{value:"Wissen van de Windows Logs",id:"wissen-van-de-windows-logs",level:3},{value:"Uitschakelen van Windows Defender",id:"uitschakelen-van-windows-defender",level:3},{value:"Detectie van persistente aanvallen via Runkey-aanpassingen",id:"detectie-van-persistente-aanvallen-via-runkey-aanpassingen",level:3},{value:"Detectie van PowerShell-gebruik",id:"detectie-van-powershell-gebruik",level:3},{value:"Uitschakelen van Windows Firewall",id:"uitschakelen-van-windows-firewall",level:3},{value:"Datacollectie van Active Directory met PowerShell",id:"datacollectie-van-active-directory-met-powershell",level:3},{value:"Inlogpoging op Windows 11 buiten werktijden",id:"inlogpoging-op-windows-11-buiten-werktijden",level:3},{value:"Inlogpoging op Windows 11 vanaf vreemd netwerk",id:"inlogpoging-op-windows-11-vanaf-vreemd-netwerk",level:3},{value:"Misbruik van de Windows Task Scheduler",id:"misbruik-van-de-windows-task-scheduler",level:3},{value:"Verdachte timestomping-activiteit",id:"verdachte-timestomping-activiteit",level:3},{value:"Verdachte scriptingbestanden in /tmp of /gebruikers folder",id:"verdachte-scriptingbestanden-in-tmp-of-gebruikers-folder",level:3}];function o(e){const n={h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"technisch-ontwerp---project-cyber-security",children:"Technisch Ontwerp - Project Cyber Security"})}),"\n",(0,r.jsx)(n.h2,{id:"inleiding",children:"Inleiding"}),"\n",(0,r.jsx)(n.h3,{id:"doel",children:"Doel"}),"\n",(0,r.jsx)(n.p,{children:'Dit document vormt het technische ontwerp voor de proof of concept "Gratis SIEM voor het mkb" op basis van Wazuh. Het doel is om:'}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Componenten en infrastructuur technisch te defini\xebren"}),"\n",(0,r.jsx)(n.li,{children:"Logbronnen, regels en validatie te beschrijven"}),"\n",(0,r.jsx)(n.li,{children:"Toegangsbeheer te structureren"}),"\n",(0,r.jsx)(n.li,{children:"Richtlijnen voor beheer en veiligheid te bieden"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"doelgroep",children:"Doelgroep"}),"\n",(0,r.jsx)(n.p,{children:"Systeem- en netwerkbeheerders binnen het mkb en externe consultants."}),"\n",(0,r.jsx)(n.h3,{id:"technische-uitgangspunten",children:"Technische uitgangspunten"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Ubuntu 22.04 LTS (8 vCPU, 8GB RAM, 100GB opslag)"}),"\n",(0,r.jsx)(n.li,{children:"Intern netwerkcommunicatie"}),"\n",(0,r.jsx)(n.li,{children:"Agents via poort 1514 TCP"}),"\n",(0,r.jsx)(n.li,{children:"Syslog via TCP 514"}),"\n",(0,r.jsx)(n.li,{children:"TLS 1.2+"}),"\n",(0,r.jsx)(n.li,{children:"Wazuh 4.12+"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"usecases",children:"Usecases"}),"\n",(0,r.jsx)(n.p,{children:"*Voorbeeld van een uitgewerkte usecase. Het volledige Technisch ontwerp is op te vragen bij de projectgroep"}),"\n",(0,r.jsx)(n.h3,{id:"detectie-van-credential-attacks-op-windows",children:"Detectie van credential attacks op Windows"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Rule IDs"}),": 100010, 100011, 100012, 100013"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Gedrag"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"LSASS dump via rundll32.exe / procdump"}),"\n",(0,r.jsx)(n.li,{children:"Credential Manager toegang via keymgr.dll"}),"\n",(0,r.jsx)(n.li,{children:"Vaultcmd uitlezing"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"scenario-password-spraying",children:"Scenario: Password spraying"}),"\n",(0,r.jsx)(n.p,{children:"In dit scenario worden pogingen tot het ongeautoriseerd verkrijgen en gebruiken van inloggegevens gedetecteerd, met nadruk op pogingen waarbij een beperkt aantal veelgebruikte wachtwoorden wordt getest op meerdere gebruikersaccounts (password spraying). Deze aanvalsmethode wordt vaak ingezet om lockouts te vermijden en langere tijd onopgemerkt te blijven."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Componenten"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Endpoints"}),": Windows 11"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Wazuh-agent"}),": Ge\xefnstalleerd op de endpoints"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Wazuh Manager"}),": Ontvangt en analyseert loggegevens"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Detectie en regels"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Gedrag"}),(0,r.jsx)(n.th,{children:"Bron"}),(0,r.jsx)(n.th,{children:"Rule ID"}),(0,r.jsx)(n.th,{children:"Beschrijving"})]})}),(0,r.jsx)(n.tbody,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Herhaalde foutieve logins op meerdere accounts"}),(0,r.jsx)(n.td,{children:"Medium"}),(0,r.jsx)(n.td,{children:"104390"}),(0,r.jsx)(n.td,{children:"Detecteert password spraying op basis van mislukte loginpogingen over accounts"})]})})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Verloop van scenario"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Een aanvaller voert inlogpogingen uit met bekende wachtwoorden op meerdere gebruikers."}),"\n",(0,r.jsx)(n.li,{children:"Windows genereert bij elke mislukte poging een event met ID."}),"\n",(0,r.jsx)(n.li,{children:"De Wazuh-agent verzamelt deze logs."}),"\n",(0,r.jsx)(n.li,{children:"De Wazuh Manager vergelijkt de logs met ingestelde regels die patronen herkennen."}),"\n",(0,r.jsx)(n.li,{children:"Bij een match wordt een alert gegenereerd."}),"\n",(0,r.jsx)(n.li,{children:"Deze alert is zichtbaar in het Wazuh-dashboard voor verdere analyse."}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Herhaalde foutieve logins op meerdere accounts"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"*Verdere usecases uit het technsich ontwerp. *"}),"\n",(0,r.jsx)(n.h3,{id:"detectie-van-malware",children:"Detectie van malware"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Rule ID"}),": 62123"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Gedrag"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Windows Defender detecteert mogelijk malware"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"toevoeging-aan-administratorsgroep",children:"Toevoeging aan administratorsgroep"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Rule ID"}),": 60160"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Gedrag"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Toevoegen van gebruiker aan admin-groep"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"bruteforce-op-windows-11",children:"Bruteforce op Windows 11"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Rule IDs"}),": 60122, 100100"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Gedrag"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Mislukte loginpogingen met verkeerde gebruikersnaam/wachtwoord"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"wissen-van-de-windows-logs",children:"Wissen van de Windows Logs"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Rule ID"}),": 63104"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Gedrag"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Event ID 104 / 1102"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"uitschakelen-van-windows-defender",children:"Uitschakelen van Windows Defender"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Rule ID"}),": 62152"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Gedrag"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Windows Defender uitgeschakeld / niet actief"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"detectie-van-persistente-aanvallen-via-runkey-aanpassingen",children:"Detectie van persistente aanvallen via Runkey-aanpassingen"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Rule ID"}),": 598"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Gedrag"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Toevoegen van register runkey in HKLM/HKCU"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"detectie-van-powershell-gebruik",children:"Detectie van PowerShell-gebruik"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Rule ID"}),": 67027"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Gedrag"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Activatie van PowerShell-proces"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"uitschakelen-van-windows-firewall",children:"Uitschakelen van Windows Firewall"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Rule ID"}),": 67005"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Gedrag"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Windows Firewall uitgeschakeld"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"datacollectie-van-active-directory-met-powershell",children:"Datacollectie van Active Directory met PowerShell"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Rule ID"}),": 100206"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Gedrag"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Powershell commando: Get-ADGroupMember"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"inlogpoging-op-windows-11-buiten-werktijden",children:"Inlogpoging op Windows 11 buiten werktijden"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Rule ID"}),": 60106"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Gedrag"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Login tussen 18:00 - 06:00"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"inlogpoging-op-windows-11-vanaf-vreemd-netwerk",children:"Inlogpoging op Windows 11 vanaf vreemd netwerk"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Rule ID"}),": 60106"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Gedrag"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Login vanaf verdacht IP-adres"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"misbruik-van-de-windows-task-scheduler",children:"Misbruik van de Windows Task Scheduler"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Rule ID"}),": 92154"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Gedrag"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Proces laadt taskschd.dll"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"verdachte-timestomping-activiteit",children:"Verdachte timestomping-activiteit"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Rule IDs"}),": 61604, 101101"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Gedrag"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Aanmaaktijd van bestand gewijzigd"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"verdachte-scriptingbestanden-in-tmp-of-gebruikers-folder",children:"Verdachte scriptingbestanden in /tmp of /gebruikers folder"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Rule ID"}),": 92200"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Gedrag"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Aanmaak van .bat, .cmd, .ps1, etc. in tijdelijke/gebruikersmap"}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>d,x:()=>t});var s=i(6540);const r={},l=s.createContext(r);function d(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);