"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[111],{7734:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>g,frontMatter:()=>i,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"wazuh/windows_agent_ossec_conf","title":"Windows Agent ossec.conf","description":"De standaard installatie route volgt het volgende PATH voor de ossec-configuratie\\\\Program Files (x86)\\\\ossec-agent. De aanvullende, vereiste configuratie is nodig voor de usecases beschreven in hoofdstuk 4 uit het Technisch Ontwerp en te vinden in de bijlage, genaamd configuratiebestand Windows ossec.conf:","source":"@site/docs/wazuh/windows_agent_ossec_conf.md","sourceDirName":"wazuh","slug":"/wazuh/windows_agent_ossec_conf","permalink":"/documentation/docs/wazuh/windows_agent_ossec_conf","draft":false,"unlisted":false,"editUrl":"https://github.com/Project-Cybersecurity-HVA/documentation/tree/main/docs/wazuh/windows_agent_ossec_conf.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Deploy Windows Agent","permalink":"/documentation/docs/wazuh/deploy_windows_agent"},"next":{"title":"Sysmonconfig.xml-bestand","permalink":"/documentation/docs/wazuh/sysmonconfig"}}');var t=o(4848),r=o(8453);const i={},a="Windows Agent ossec.conf",c={},l=[];function d(e){const n={code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"windows-agent-ossecconf",children:"Windows Agent ossec.conf"})}),"\n",(0,t.jsxs)(n.p,{children:["De standaard installatie route volgt het volgende ",(0,t.jsx)(n.code,{children:"PATH"})," voor de ",(0,t.jsx)(n.code,{children:"ossec"}),"-configuratie: ",(0,t.jsx)(n.code,{children:"C:\\Program Files (x86)\\ossec-agent"}),". De aanvullende, vereiste configuratie is nodig voor de usecases beschreven in hoofdstuk 4 uit het Technisch Ontwerp en te vinden in de bijlage, genaamd configuratiebestand Windows ",(0,t.jsx)(n.code,{children:"ossec.conf"}),":"]}),"\n",(0,t.jsxs)(n.p,{children:["Herstart de agent op Windows na elke aanpassing op het ossec.conf-bestand met het volgende commando:\n",(0,t.jsx)(n.code,{children:"Restart-Service -Name Wazuh"})]}),"\n",(0,t.jsxs)(n.p,{children:["Hieronder vind je het ",(0,t.jsx)(n.code,{children:"ossec.conf"}),"-configuratiebestand voor de Wazuh Windows agent:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:'\x3c!--\n  Wazuh - Agent - Default configuration for Windows\n  More info at: https://documentation.wazuh.com\n  Mailing list: https://groups.google.com/forum/#!forum/wazuh\n--\x3e\n\n<ossec_config>\n\n  <client>\n    <server>\n      <address>127.0.0.1</address>\n      <port>1514</port>\n      <protocol>tcp</protocol>\n    </server>\n    <config-profile>windows, windows10</config-profile>\n    <crypto_method>aes</crypto_method>\n    <notify_time>10</notify_time>\n    <time-reconnect>60</time-reconnect>\n    <auto_restart>yes</auto_restart>\n    <enrollment>\n      <enabled>yes</enabled>\n      <agent_name>GONGOELOE</agent_name>\n    </enrollment>\n  </client>\n\n  <client_buffer>\n    <disabled>no</disabled>\n    <queue_size>5000</queue_size>\n    <events_per_second>500</events_per_second>\n  </client_buffer>\n\n  \x3c!-- Logbronnen Windows Eventchannels --\x3e\n  <localfile>\n    <location>Security</location>\n    <log_format>eventchannel</log_format>\n    <query>Event[System[EventID=4688] and EventData[Data[@Name=\'NewProcessName\']=\'C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\']]</query>\n    <query>Event[System/EventID=104]</query>\n    <query>Event[System/EventID=1102]</query>\n  </localfile>\n\n  <localfile>\n    <location>System</location>\n    <log_format>eventchannel</log_format>\n  </localfile>\n\n  <localfile>\n    <location>Microsoft-Windows-Windows Firewall With Advanced Security/Firewall</location>\n    <log_format>eventchannel</log_format>\n  </localfile>\n\n  <localfile>\n    <location>Microsoft-Windows-Windows Defender/Operational</location>\n    <log_format>eventchannel</log_format>\n  </localfile>\n\n  <localfile>\n    <location>Microsoft-Windows-Sysmon/Operational</location>\n    <log_format>eventchannel</log_format>\n  </localfile>\n\n  <localfile>\n    <location>active-response\\\\active-responses.log</location>\n    <log_format>syslog</log_format>\n  </localfile>\n\n  <rootcheck>\n    <disabled>no</disabled>\n    <windows_apps>./shared/win_applications_rcl.txt</windows_apps>\n    <windows_malware>./shared/win_malware_rcl.txt</windows_malware>\n  </rootcheck>\n\n  <sca>\n    <enabled>yes</enabled>\n    <scan_on_start>yes</scan_on_start>\n    <interval>12h</interval>\n    <skip_nfs>yes</skip_nfs>\n  </sca>\n\n  <syscheck>\n    <disabled>no</disabled>\n    <frequency>43200</frequency>\n\n    \x3c!-- Kritieke Windows-directories --\x3e\n    <directories recursion_level="0" restrict="regedit.exe$|system.ini$|win.ini$">%WINDIR%</directories>\n    <directories recursion_level="0">%WINDIR%\\\\SysNative\\\\drivers\\\\etc</directories>\n    <directories recursion_level="0">%WINDIR%\\\\System32\\\\drivers\\\\etc</directories>\n\n    \x3c!-- Executables en scripts --\x3e\n    <directories recursion_level="0" restrict="powershell.exe$">%WINDIR%\\\\System32\\\\WindowsPowerShell\\\\v1.0</directories>\n    <directories recursion_level="0" restrict="winrm.vbs$">%WINDIR%\\\\System32</directories>\n\n    \x3c!-- Real-time monitoring --\x3e\n    <directories realtime="yes">%PROGRAMDATA%\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup</directories>\n\n    \x3c!-- Uitsluitingen --\x3e\n    <ignore>%PROGRAMDATA%\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\desktop.ini</ignore>\n    <ignore type="sregex">.log$|.htm$|.jpg$|.png$|.chm$|.pnf$|.evtx$</ignore>\n\n    \x3c!-- Registry monitoring --\x3e\n    <windows_registry arch="both">HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run</windows_registry>\n    <windows_registry arch="both">HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce</windows_registry>\n    <registry_ignore>HKEY_LOCAL_MACHINE\\\\Security\\\\Policy\\\\Secrets</registry_ignore>\n    <registry_ignore>HKEY_LOCAL_MACHINE\\\\Security\\\\SAM\\\\Domains\\\\Account\\\\Users</registry_ignore>\n    <registry_ignore type="sregex">\\\\Enum$</registry_ignore>\n    <registry_ignore>HKEY_LOCAL_MACHINE\\\\System\\\\CurrentControlSet\\\\Services\\\\MpsSvc\\\\Parameters\\\\AppCs</registry_ignore>\n    \x3c!-- overige registry_ignores blijven gelijk --\x3e\n\n    \x3c!-- Instellingen --\x3e\n    <windows_audit_interval>60</windows_audit_interval>\n    <process_priority>10</process_priority>\n    <max_eps>50</max_eps>\n\n    <synchronization>\n      <enabled>yes</enabled>\n      <interval>5m</interval>\n      <max_eps>10</max_eps>\n    </synchronization>\n  </syscheck>\n\n  <wodle name="syscollector">\n    <disabled>no</disabled>\n    <interval>1h</interval>\n    <scan_on_start>yes</scan_on_start>\n    <hardware>yes</hardware>\n    <os>yes</os>\n    <network>yes</network>\n    <packages>yes</packages>\n    <ports all="no">yes</ports>\n    <processes>yes</processes>\n    <synchronization>\n      <max_eps>10</max_eps>\n    </synchronization>\n  </wodle>\n\n  <wodle name="cis-cat">\n    <disabled>yes</disabled>\n    <timeout>1800</timeout>\n    <interval>1d</interval>\n    <scan-on-start>yes</scan-on-start>\n    <java_path>\\\\server\\\\jre\\\\bin\\\\java.exe</java_path>\n    <ciscat_path>C:\\\\cis-cat</ciscat_path>\n  </wodle>\n\n  <wodle name="osquery">\n    <disabled>yes</disabled>\n    <run_daemon>yes</run_daemon>\n    <bin_path>C:\\\\Program Files\\\\osquery\\\\osqueryd</bin_path>\n    <log_path>C:\\\\Program Files\\\\osquery\\\\log\\\\osqueryd.results.log</log_path>\n    <config_path>C:\\\\Program Files\\\\osquery\\\\osquery.conf</config_path>\n    <add_labels>yes</add_labels>\n  </wodle>\n\n  <wodle name="eventchannel">\n    <enabled>yes</enabled>\n    <read_interval>5</read_interval>\n    <location>Security</location>\n    <query>Event/System[EventID=1102]</query>\n  </wodle>\n\n  <active-response>\n    <disabled>no</disabled>\n    <ca_store>wpk_root.pem</ca_store>\n    <ca_verification>yes</ca_verification>\n  </active-response>\n\n  <logging>\n    <log_format>plain</log_format>\n  </logging>\n\n</ossec_config>\n\n'})})]})}function g(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>i,x:()=>a});var s=o(6540);const t={},r=s.createContext(t);function i(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);