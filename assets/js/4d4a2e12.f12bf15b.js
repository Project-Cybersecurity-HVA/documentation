"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[252],{171:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/wazuh_alert_credentials_attack_2-df9128fe2bb05dcbb5f0d40b5ec0479f.png"},1091:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/event_viewer_task_scheduler-8e13affb64ff2df2251345caf00c58eb.png"},1252:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/wazuh_alert_system_log_cleared-33f7eba66789c77ad610622014ed99e6.png"},2374:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/wazuh_alert_powershell_activated-8b37a77ae6e7f67d00f4625901cc0577.png"},3224:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/wazuh_alert_registry_key_modified-086aea9740f1433995295c5c3a807ff1.png"},3704:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/wazuh_alert_credentials_attack-dc95691d645b0b31004e8e6645705c97.png"},3979:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/event_viewer_system_log_cleared-049aa9ddad4553d19ab1cf32db2be1ef.png"},4611:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/wazuh_alert_uitschakelen_windows_defender-7498778de107198dfd79f82142e26ddb.png"},5348:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/wazuh_alert_uitschakelen_windows_defender_2-6f9019eed6130d0390009cd22cca19cb.png"},6082:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"testen_van_de_usecases","title":"Testen van de Usecases","description":"_NOTE:_ De logging moet via audit policy toegestaan zijn voor verschillende Windows usecases, zoals beschreven in het Functioneel ontwerp","source":"@site/docs/testen_van_de_usecases.md","sourceDirName":".","slug":"/testen_van_de_usecases","permalink":"/documentation/docs/testen_van_de_usecases","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/testen_van_de_usecases.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Installatie en Configuratie","permalink":"/documentation/docs/Installatie_en_Configuratie"},"next":{"title":"Installatie en Deploy van de Wazuh Windows-Agent","permalink":"/documentation/docs/wazuh/agent_configuratie"}}');var a=n(4848),i=n(8453);const r={},d="Testen van de Usecases",c={},l=[{value:"Usecase Wissen van de Windows Logs",id:"usecase-wissen-van-de-windows-logs",level:2},{value:"Usecase Detectie van PowerShell-gebruik",id:"usecase-detectie-van-powershell-gebruik",level:2},{value:"Usecase Detectie van persistente aanvallen via Windows Registry Runkeys",id:"usecase-detectie-van-persistente-aanvallen-via-windows-registry-runkeys",level:2},{value:"Usecase Toevoegen aan de administratorsgroep",id:"usecase-toevoegen-aan-de-administratorsgroep",level:2},{value:"Usecase Detectie van credential attacks op Windows",id:"usecase-detectie-van-credential-attacks-op-windows",level:2},{value:"Usecase Ongewenste Software",id:"usecase-ongewenste-software",level:2},{value:"Usecase Uitschakelen van Windows Defender",id:"usecase-uitschakelen-van-windows-defender",level:3},{value:"Usecase Misbruik van de Windows Task Scheduler",id:"usecase-misbruik-van-de-windows-task-scheduler",level:3}];function o(e){const s={blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.header,{children:(0,a.jsx)(s.h1,{id:"testen-van-de-usecases",children:"Testen van de Usecases"})}),"\n",(0,a.jsxs)(s.blockquote,{children:["\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:(0,a.jsx)(s.em,{children:"NOTE:"})})," De logging moet via audit policy toegestaan zijn voor verschillende Windows usecases, zoals beschreven in het Functioneel ontwerp"]}),"\n"]}),"\n",(0,a.jsx)(s.h2,{id:"usecase-wissen-van-de-windows-logs",children:"Usecase Wissen van de Windows Logs"}),"\n",(0,a.jsx)(s.p,{children:"Uit te voeren met het volgende commmando in PowerShell met beheerrechten:"}),"\n",(0,a.jsxs)(s.p,{children:["Voor het wissen van Systeem logs:\n",(0,a.jsx)(s.code,{children:"Clear-EventLog -LogName System"})]}),"\n",(0,a.jsxs)(s.p,{children:["Voor het wissen van Security logs:\n",(0,a.jsx)(s.code,{children:"Clear-EventLog -LogName Security"})]}),"\n",(0,a.jsx)(s.p,{children:"In de event viewer is het event gelijk te zien en een paar seconden later in Wazuh alert viewer:"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Event Viewer:"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Eventviewer usecase logs",src:n(3979).A+"",width:"806",height:"412"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Wazuh Alert:"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Wazuh alert system log cleared",src:n(1252).A+"",width:"1189",height:"1054"})}),"\n",(0,a.jsx)(s.h2,{id:"usecase-detectie-van-powershell-gebruik",children:"Usecase Detectie van PowerShell-gebruik"}),"\n",(0,a.jsx)(s.p,{children:"Uit te voeren met het volgende commmando in PowerShell met beheerrechten:"}),"\n",(0,a.jsxs)(s.p,{children:["Voor het activeren van Powershell:\n",(0,a.jsx)(s.code,{children:"Start-Process Powershell.exe"})]}),"\n",(0,a.jsx)(s.p,{children:"In de event viewer is het event gelijk te zien en een paar seconden later in Wazuh alert viewer:"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Wazuh Alert:"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Wazuh alert powershell activated",src:n(2374).A+"",width:"1272",height:"724"})}),"\n",(0,a.jsx)(s.h2,{id:"usecase-detectie-van-persistente-aanvallen-via-windows-registry-runkeys",children:"Usecase Detectie van persistente aanvallen via Windows Registry Runkeys"}),"\n",(0,a.jsx)(s.p,{children:"Uit te voeren met het volgende commmando in PowerShell met beheerrechten:"}),"\n",(0,a.jsx)(s.p,{children:"Voor het activeren van Powershell:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{children:'New-ItemProperty -Path "HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Run" `\n-Name "TestPersister" -Value "C:\\Windows\\System32\\notepad.exe" -PropertyType "String"\n'})}),"\n",(0,a.jsx)(s.p,{children:"In de event viewer is het event gelijk te zien en een FIM system check later in Wazuh alert viewer en FIM module viewer:"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Wazuh Alert:"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Wazuh alert registry key modified",src:n(3224).A+"",width:"1722",height:"602"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Wazuh FIM events:"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Wazuh alert regsitry keys",src:n(7817).A+"",width:"1427",height:"674"})}),"\n",(0,a.jsx)(s.h2,{id:"usecase-toevoegen-aan-de-administratorsgroep",children:"Usecase Toevoegen aan de administratorsgroep"}),"\n",(0,a.jsx)(s.p,{children:"Maak eerst een testgebruiker aan met de volgende commando:"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.code,{children:'New-LocalUser -Name "testuser" -Password (ConvertTo-SecureString "Heelgoedenveilig!!!" -AsPlainText -Force)'})}),"\n",(0,a.jsx)(s.p,{children:"Voeg een gebruiker aan de administrator groep:"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.code,{children:'Add-LocalGroupMember -Group "Administrators" -Member "testuser" '})}),"\n",(0,a.jsx)(s.p,{children:"Nu zie je dat er een high alert is op de wazuh dashboard:"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Wazuh Alert:"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Wazuh alert added to admin group",src:n(8690).A+"",width:"1046",height:"845"})}),"\n",(0,a.jsx)(s.h2,{id:"usecase-detectie-van-credential-attacks-op-windows",children:"Usecase Detectie van credential attacks op Windows"}),"\n",(0,a.jsx)(s.p,{children:"Om nu de usecase te testen kan je een van de volgende commando\u2019s op de powershell van de Windows systeem uitvoeren:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-powershell",children:'rundll32.exe C:\\Windows\\System32\\comsvcs.dll, MiniDump 624 C:\\temp\\lsass.dmp full \nrundll32 keymgr.dll,KRShowKeyMgr \nvaultcmd /listcreds:"Windows Credentials" /all \n'})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Wazuh Alert:"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.img,{alt:"Wazuh alert credentials attack",src:n(3704).A+"",width:"1043",height:"887"}),"\n",(0,a.jsx)(s.img,{alt:"Wazuh alert credentials attack",src:n(171).A+"",width:"901",height:"885"}),"\n",(0,a.jsx)(s.img,{alt:"Wazuh alert credentials attack",src:n(9666).A+"",width:"901",height:"711"})]}),"\n",(0,a.jsx)(s.h2,{id:"usecase-ongewenste-software",children:"Usecase Ongewenste Software"}),"\n",(0,a.jsx)(s.p,{children:"Om nu de usecase te testen voer het volgende commando op de powershell van de Windows systeem uitvoeren:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{children:"Set-Content \"$env:USERPROFILE\\Desktop\\eicar.com\" 'X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*' \n"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Wazuh Alert:"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Wazuh alert ongewenste software",src:n(7196).A+"",width:"877",height:"726"})}),"\n",(0,a.jsx)(s.h3,{id:"usecase-uitschakelen-van-windows-defender",children:"Usecase Uitschakelen van Windows Defender"}),"\n",(0,a.jsxs)(s.p,{children:["Voer het volgende commando uit in Powershell om een ",(0,a.jsx)(s.code,{children:".bat"}),"-bestand aan te maken in de ",(0,a.jsx)(s.code,{children:"TEMP"}),"-folder:"]}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.code,{children:'echo "echo hello" > "$env:TEMP\\Hacked_me.bat" '})}),"\n",(0,a.jsx)(s.p,{children:"Vervolgens genereert Sysmon een melding in de eventviewer met ID 11:"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Windows Event_viewer:"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Wazuh alert uitschakelen Windows Defender",src:n(4611).A+"",width:"904",height:"436"})}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.strong,{children:"Wazuh Event_viewer:"}),"\n",(0,a.jsx)(s.img,{alt:"Wazuh alert uitschakelen Windows Defender",src:n(5348).A+"",width:"906",height:"447"})]}),"\n",(0,a.jsx)(s.h3,{id:"usecase-misbruik-van-de-windows-task-scheduler",children:"Usecase Misbruik van de Windows Task Scheduler"}),"\n",(0,a.jsx)(s.p,{children:"Voer het volgende commando uit in Powershell om het taskschd.dll module te laden:"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.code,{children:"Start-Process schtasks.exe "})}),"\n",(0,a.jsx)(s.p,{children:"Vervolgens genereert Sysmon een melding in de eventviewer met ID 7:"}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Windows Event_viewer:"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Wazuh alert uitschakelen Windows Defender",src:n(1091).A+"",width:"897",height:"519"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.strong,{children:"Wazuh Event_viewer:"})}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.img,{alt:"Wazuh alert uitschakelen Windows Defender",src:n(8556).A+"",width:"909",height:"423"})})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(o,{...e})}):o(e)}},7196:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/wazuh_alert_ongewenste_software-ebf2d0f3b842c342cfd8040931ad043b.png"},7817:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/wazuh_alert_viewer_registry-41109355c380560b231777eafd7b03c6.png"},8453:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>d});var t=n(6540);const a={},i=t.createContext(a);function r(e){const s=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),t.createElement(i.Provider,{value:s},e.children)}},8556:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/wazuh_alert_task_scheduler-47a6bf54e1ea42eadb256334d9ac4998.png"},8690:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/wazuh_alert_adding_admin_groep-6d947055148fb682fbe3842b82545b67.png"},9666:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/wazuh_alert_credentials_attack_3-87a049937613ccd03355628429fc5e86.png"}}]);