"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[492],{3330:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>d,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"wazuh/local_rules","title":"Local Rules (Wazuh)","description":"Hieronder vind je de lokale regels voor Wazuh, zoals gebruikt in deze implementatie:","source":"@site/docs/wazuh/local_rules.md","sourceDirName":"wazuh","slug":"/wazuh/local_rules","permalink":"/documentation/docs/wazuh/local_rules","draft":false,"unlisted":false,"editUrl":"https://github.com/Project-Cybersecurity-HVA/documentation/tree/main/docs/wazuh/local_rules.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Installatie en Deploy van de Wazuh Windows-Agent","permalink":"/documentation/docs/wazuh/agent_configuratie"},"next":{"title":"Docker Compose Configuratie","permalink":"/documentation/docs/wazuh/docker_compose"}}');var a=i(4848),r=i(8453);const d={},o="Local Rules (Wazuh)",s={},l=[];function c(e){const n={code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"local-rules-wazuh",children:"Local Rules (Wazuh)"})}),"\n",(0,a.jsx)(n.p,{children:"Hieronder vind je de lokale regels voor Wazuh, zoals gebruikt in deze implementatie:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:'<group name="local">\n\n  \x3c!-- SSHD brute-force vanaf bekend IP (voorbeeld UNIX) --\x3e\n  <rule id="100001" level="5">\n    <if_sid>5716</if_sid>\n    <srcip>1.1.1.1</srcip>\n    <description>sshd: authentication failed from IP 1.1.1.1.</description>\n    <group>authentication_failed,pci_dss_10.2.4,pci_dss_10.2.5</group>\n  </rule>\n\n</group>\n\n<group name="rdp">\n\n  \x3c!-- Herhaalde RDP-aanmeldingen --\x3e\n  <rule id="100002" level="10" frequency="3" timeframe="120">\n    <if_matched_sid>60122</if_matched_sid>\n    <description>RDP Attack Detected</description>\n  </rule>\n\n</group>\n\n<group name="apache">\n\n  \x3c!-- Apache: verboden bestandspad geprobeerd --\x3e\n  <rule id="100003" level="5">\n    <if_sid>30101</if_sid>\n    <match>denied by server configuration</match>\n    <description>Apache: Attempt to access forbidden file or directory.</description>\n    <group>access_denied</group>\n  </rule>\n\n</group>\n\n<group name="windows,windows_security">\n\n  \x3c!-- Password reset attempt (Event ID 4724) --\x3e\n  <rule id="100004" level="8">\n    <if_sid>60103</if_sid>\n    <field name="win.system.eventID">^4724$</field>\n    <description>Attempt to reset password for: $(win.eventdata.TargetUserName).</description>\n    <options>no_full_log</options>\n  </rule>\n\n  \x3c!-- Aanmaken van nieuw gebruikersaccount (Event ID 4720) --\x3e\n  <rule id="100005" level="8">\n    <field name="win.system.eventID">4720</field>\n    <description>New user account created: $(win.eventdata.TargetUserName).</description>\n  </rule>\n\n  \x3c!-- Auditlog gewist (Event ID 1102) --\x3e\n  <rule id="100006" level="10">\n    <field name="win.system.eventID">1102</field>\n    <description>The audit log was cleared. Mogelijke poging om sporen te wissen.</description>\n  </rule>\n\n</group>\n\n<group name="windows,powershell">\n\n  \x3c!-- Start van PowerShell (Event ID 4688) --\x3e\n  <rule id="100007" level="10">\n    <field name="win.system.eventID">4688</field>\n    <field name="win.eventdata.NewProcessName">(?i).*\\\\powershell.exe$|.*\\\\pwsh.exe$</field>\n    <description>PowerShell-process gestart via Event ID 4688</description>\n  </rule>\n\n</group>\n\n<group name="windows,registry">\n\n  \x3c!-- Wijziging aan Run registry key --\x3e\n  <rule id="100008" level="10">\n    <if_sid>598</if_sid>\n    <description>Nieuwe waarde toegevoegd aan Windows Run registry key. Mogelijke persistente aanval.</description>\n    <mitre>\n      <id>T1547.001</id>\n    </mitre>\n  </rule>\n\n</group>\n\n<group name="Windows,attack,">\n  \x3c!-- Detecting an LSASS memory dumping attack using Rundll32.exe Minidump Function or Comsvcs.dll Exploitation --\x3e\n  <rule id="100010" level="10">\n    <if_sid>61609</if_sid>\n    <field name="win.eventdata.image" type="pcre2">(?i)\\\\\\\\rundll32.exe</field>\n    <field name="win.eventdata.imageLoaded" type="pcre2">(?i)[c-z]:\\\\\\\\Windows\\\\\\\\System32\\\\\\\\comsvcs\\.dll</field>\n    <description>Possible adversary activity - LSASS memory dump: $(win.eventdata.imageLoaded) loaded by using $(win.eventData.image) on $(win.system.computer).</description>\n    <mitre>\n      <id>T1003.001</id>\n    </mitre>\n  </rule>\n\n  \x3c!-- Detecting an LSASS memory dumping attack using specialized tools --\x3e\n  <rule id="100011" level="10">\n    <if_sid>61613</if_sid>\n    <field name="win.eventData.targetFilename" type="pcre2">(?i)\\\\\\\\[^\\\\]*\\.dmp$</field>\n    <field name="win.eventData.image" negate="yes" type="pcre2">(?i)\\\\\\\\lsass.*</field>\n    <description>Possible adversary activity - LSASS memory dump: $(win.eventdata.image) created a new file on $(win.system.computer) endpoint.</description>\n    <mitre>\n      <id>T1003.001</id>\n    </mitre>\n  </rule>\n\n  \x3c!-- Detecting a Windows Credential Manager exploitation attack --\x3e\n  <rule id="100012" level="10">\n    <if_sid>61603</if_sid>\n    <field name="win.eventData.Image" type="pcre2">(?i)\\\\\\\\rundll32.exe</field>\n    <field name="win.eventData.commandLine" type="pcre2">keymgr.dll,KRShowKeyMgr</field>\n    <description>Possible adversary activity - Credential Manager Access via $(win.eventData.Image) on $(win.system.computer) endpoint.</description>\n    <mitre>\n      <id>T1003</id>\n    </mitre>\n  </rule>\n\n  \x3c!--  Detecting a Windows Credential Manager exploitation attack by VaultCmd process enumeration --\x3e\n  <rule id="100013" level="10">\n    <if_sid>92052</if_sid>\n    <field name="win.eventData.image" type="pcre2">(?i)\\\\\\\\vaultcmd.exe</field>\n    <field name="win.eventData.commandLine" type="pcre2">list</field>\n    <description>Possible adversary activity - Attempt to list credentials via $(win.eventData.Image) on $(win.system.computer) endpoint.</description>\n    <mitre>\n      <id>T1003</id>\n    </mitre>\n  </rule>\n\n</group>\n'})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>d,x:()=>o});var t=i(6540);const a={},r=t.createContext(a);function d(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:d(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);