"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[492],{3330:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"wazuh/local_rules","title":"Local Rules (Wazuh)","description":"Hieronder vind je de lokale regels voor Wazuh, zoals gebruikt in deze implementatie:","source":"@site/docs/wazuh/local_rules.md","sourceDirName":"wazuh","slug":"/wazuh/local_rules","permalink":"/documentation/docs/wazuh/local_rules","draft":false,"unlisted":false,"editUrl":"https://github.com/Project-Cybersecurity-HVA/documentation/tree/main/docs/wazuh/local_rules.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Installatie en Deploy van de Wazuh Windows-Agent","permalink":"/documentation/docs/wazuh/agent_configuratie"},"next":{"title":"Docker Compose Configuratie","permalink":"/documentation/docs/wazuh/docker_compose"}}');var d=i(4848),o=i(8453);const r={},l="Local Rules (Wazuh)",s={},a=[];function c(e){const n={code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsx)(n.h1,{id:"local-rules-wazuh",children:"Local Rules (Wazuh)"})}),"\n",(0,d.jsx)(n.p,{children:"Hieronder vind je de lokale regels voor Wazuh, zoals gebruikt in deze implementatie:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<rules>\n\n  \x3c!-- Brute force detection --\x3e\n  <group name="windows_brute_force">\n    <rule id="100100" level="10" frequency="3" timeframe="120">\n      <if_matched_sid>60122</if_matched_sid>\n      <description>Possible Windows Brute Force: 3 failed logons in 2 minutes</description>\n    </rule>\n  </group>\n\n  \x3c!-- Sysmon Event ID 7 detection --\x3e\n  <group name="sysmon_eid7_detections">\n    <rule id="92154" level="4">\n      <if_group>sysmon_event7</if_group>\n      <field name="win.eventdata.imageLoaded" type="pcre2">(?i)taskschd\\.dll</field>\n      <options>no_full_log</options>\n      <description>Process loaded taskschd.dll module. May be used to create delayed malware execution</description>\n      <mitre>\n        <id>T1053.005</id>\n      </mitre>\n    </rule>\n  </group>\n\n  \x3c!-- Sysmon Event ID 11 detection --\x3e\n  <group name="sysmon_eid11_detections">\n    <rule id="92213" level="15">\n      <if_group>sysmon_event_11</if_group>\n      <field name="win.eventdata.targetFilename" type="pcre2">(?i)[c-z]:\\\\Users\\\\.+\\\\AppData\\\\Local\\\\Temp\\\\.+\\.(exe|com|dll|vbs|js|bat|cmd|pif|wsh|ps1|msi|vbe)</field>\n      <options>no_full_log</options>\n      <description>Executable file dropped in folder commonly used by malware</description>\n      <mitre>\n        <id>T1105</id>\n      </mitre>\n    </rule>\n  </group>\n\n  \x3c!-- Credential Dumping and Credential Access --\x3e\n  <group name="windows_credential_attacks">\n    <rule id="100010" level="10">\n      <if_sid>61609</if_sid>\n      <field name="win.eventdata.image" type="pcre2">(?i)\\\\rundll32.exe</field>\n      <field name="win.eventdata.imageLoaded" type="pcre2">(?i)[c-z]:\\\\Windows\\\\System32\\\\comsvcs\\.dll</field>\n      <description>Possible adversary activity - LSASS memory dump via rundll32 and comsvcs.dll</description>\n      <mitre><id>T1003.001</id></mitre>\n    </rule>\n\n    <rule id="100011" level="10">\n      <if_sid>61613</if_sid>\n      <field name="win.eventData.targetFilename" type="pcre2">(?i)\\\\[^\\\\]*\\.dmp$</field>\n      <field name="win.eventData.image" negate="yes" type="pcre2">(?i)\\\\lsass.*</field>\n      <description>Possible LSASS memory dump - .dmp file created not by lsass</description>\n      <mitre><id>T1003.001</id></mitre>\n    </rule>\n\n    <rule id="100012" level="10">\n      <if_sid>61603</if_sid>\n      <field name="win.eventData.Image" type="pcre2">(?i)\\\\rundll32.exe</field>\n      <field name="win.eventData.commandLine" type="pcre2">keymgr.dll,KRShowKeyMgr</field>\n      <description>Credential Manager access via rundll32</description>\n      <mitre><id>T1003</id></mitre>\n    </rule>\n\n    <rule id="100013" level="10">\n      <if_sid>92052</if_sid>\n      <field name="win.eventData.image" type="pcre2">(?i)\\\\vaultcmd.exe</field>\n      <field name="win.eventData.commandLine" type="pcre2">list</field>\n      <description>Credential listing attempt via vaultcmd</description>\n      <mitre><id>T1003</id></mitre>\n    </rule>\n  </group>\n\n  \x3c!-- BloodHound/SharpHound detection --\x3e\n  <group name="sharphound">\n    <rule id="111151" level="7">\n      <if_sid>61603</if_sid>\n      <field name="win.eventdata.company" type="pcre2">^SpecterOps$</field>\n      <description>SharpHound binary executed</description>\n      <mitre><id>T1033</id></mitre>\n    </rule>\n\n    <rule id="111152" level="12">\n      <if_sid>61603</if_sid>\n      <field name="win.eventdata.parentImage" type="pcre2">(?i)[c-z]:\\\\Windows\\\\System32\\\\.+\\\\(powershell|cmd)\\.exe</field>\n      <field name="win.eventdata.commandLine" type="pcre2">(?i)((--CollectionMethods\\s)((.+){1,12})|(\\s(--Loop)))</field>\n      <description>SharpHound CollectionMethods flag detected</description>\n      <mitre><id>T1059.00</id><id>T1033</id></mitre>\n    </rule>\n\n    <rule id="111153" level="12">\n      <if_sid>61603</if_sid>\n      <field name="win.eventdata.parentImage" type="pcre2">(?i)[c-z]:\\\\Windows\\\\System32\\\\.+\\\\(powershell|cmd)\\.exe</field>\n      <field name="win.eventdata.commandLine" type="pcre2">(?i)((invoke-bloodhound\\s)|(get-bloodHounddata\\s))</field>\n      <description>SharpHound PowerShell cmdlet detected</description>\n      <mitre><id>T1059.00</id><id>T1033</id></mitre>\n    </rule>\n  </group>\n\n  \x3c!-- Custom rules --\x3e\n  <group name="custom_rules">\n    <rule id="100111" level="5">\n      <if_sid>60106</if_sid>\n      <time>6 pm - 8:30 am</time>\n      <description>Windows Logon Success outside office hours</description>\n      <options>no_full_log</options>\n    </rule>\n\n    <rule id="100112" level="8">\n      <if_sid>92651</if_sid>\n      <field name="win.eventdata.ipAddress" type="pcre2">^192\\.168\\.56\\.([1-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-4])$</field>\n      <description>Remote Logon from unknown network</description>\n    </rule>\n\n    <rule id="100113" level="5">\n      <if_sid>60009</if_sid>\n      <field name="win.eventdata.contextInfo" type="pcre2">\\bGet-ADGroupMember\\b *</field>\n      <description>Get-ADGroupMember PowerShell executed</description>\n    </rule>\n  </group>\n\n</rules>\n\n'})})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>l});var t=i(6540);const d={},o=t.createContext(d);function r(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:r(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);